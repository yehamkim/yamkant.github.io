<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[Study] Python Clean Code - Good Code - Yam’s Dev Logs</title>
<meta name="description" content="계약에 의한 디자인    계약: 소프트웨어 컴포넌트 간의 통신 중에 반드시 지켜져야 하는 규칙을 강제하는 것입니다.   사전조건: 코드가 실행되기 전에 확인해야 할 조건들로, 유효성 검사, DB 및 파일 등에 대한 것들로, 서버가 담당할 부분입니다.   사후조건: 코드 실행 이후에 함수 반환 값의 유효성 검사로, 클라이언트가 담당할 부분입니다.   위의 두 가지 조건을 통해, 책임소재를 신속히 파악할 수 있습니다. 사전조건 검증에 실패한다면 클라이언트의 결함, 사후조건에 실패하면 컴포넌트의 결함입니다.">


  <meta name="author" content="Yeham Kim">
  
  <meta property="article:author" content="Yeham Kim">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Yam's Dev Logs">
<meta property="og:title" content="[Study] Python Clean Code - Good Code">
<meta property="og:url" content="http://localhost:4000/study/study-cleancode-goodcode/">


  <meta property="og:description" content="계약에 의한 디자인    계약: 소프트웨어 컴포넌트 간의 통신 중에 반드시 지켜져야 하는 규칙을 강제하는 것입니다.   사전조건: 코드가 실행되기 전에 확인해야 할 조건들로, 유효성 검사, DB 및 파일 등에 대한 것들로, 서버가 담당할 부분입니다.   사후조건: 코드 실행 이후에 함수 반환 값의 유효성 검사로, 클라이언트가 담당할 부분입니다.   위의 두 가지 조건을 통해, 책임소재를 신속히 파악할 수 있습니다. 사전조건 검증에 실패한다면 클라이언트의 결함, 사후조건에 실패하면 컴포넌트의 결함입니다.">







  <meta property="article:published_time" content="2023-08-12T00:05:07+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/study/study-cleancode-goodcode/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Yeham Kim",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Yam's Dev Logs Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--archive">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Yam's Dev Logs
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
<div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Yeham Kim</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>제품을 만드는 개발자입니다.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Seoul</span>
        </li>
      

      
        
          
            <li><a href="mailto:dev.yamkim@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/yamkant" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  

  
  <!--전체 글 수를 세기 위한 연산. sum 변수에 전체 글 수 저장-->



<nav class="nav__list">
    <input id="ac-toc" name="accordion-toc" type="checkbox" />
    <label for="ac-toc">Toggle menu</label>
    <ul class="nav__items" id="category_tag_menu">
        <!--전체 글 수-->
        <li style="font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;">
            📂 <span>Total Posts: 46</span>
        </li>
        <li>
            <!--span 태그로 카테고리들을 크게 분류 ex) C/C++/C#-->
            <span class="nav__sub-title">Django</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시-->
                
                
                
                
                
                
                
                
                <li><a href="/categories/django-strategy" class="">Django Strategy (14)</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
            </ul>
            <ul>
                
                
                
                
                <li><a href="/categories/django-deep" class="">Django Deep (2)</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </ul>
            <span class="nav__sub-title">Server</span>
            <ul>
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/categories/server" class="">Server (3)</a></li>
                
                
                
                
                
                
                
                
            </ul>
            <span class="nav__sub-title">Study</span>
            <ul>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/categories/django-study" class="">Django Study (3)</a></li>
                
                
                
                
            </ul>
            <ul>
                
                
                
                
                
                
                <li><a href="/categories/study" class="">study (17)</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </ul>
            <span class="nav__sub-title">Error Handle</span>
            <ul>
                
                
                <li><a href="/categories/error-async" class="">비동기 처리 (2)</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </ul>
            <span class="nav__sub-title">Database</span>
            <ul>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/categories/database" class="">SQL (1)</a></li>
                
                
                
                
                
                
            </ul>
        </li>
    </ul>
</nav>
  

</div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">[Study] Python Clean Code - Good Code</h1>
    
    <h2 id="계약에-의한-디자인">계약에 의한 디자인</h2>
<ul>
  <li>계약: 소프트웨어 컴포넌트 간의 통신 중에 반드시 지켜져야 하는 규칙을 강제하는 것입니다.</li>
  <li>사전조건: 코드가 실행되기 전에 확인해야 할 조건들로, 유효성 검사, DB 및 파일 등에 대한 것들로, 서버가 담당할 부분입니다.</li>
  <li>사후조건: 코드 실행 이후에 함수 반환 값의 유효성 검사로, 클라이언트가 담당할 부분입니다.</li>
  <li>위의 두 가지 조건을 통해, 책임소재를 신속히 파악할 수 있습니다. 사전조건 검증에 실패한다면 클라이언트의 결함, 사후조건에 실패하면 컴포넌트의 결함입니다.</li>
</ul>

<h3 id="사전조건precondition">사전조건(precondition)</h3>
<ul>
  <li>함수나 메서드가 제대로 동작하기 위해 보장해야 하는 모든 것을 의미하며, 적절한 데이터를 전달해야 합니다.</li>
  <li>파이썬은 동적으로 타입이 결정되기 때문에, 전달된 데이터가 적절한 타입인지 확인하는 경우도 있습니다.</li>
  <li>클라이언트가 함수를 호출하기 전, 모든 유효성을 검사하는 방식은 tolerant 접근법으로, 함수가 어떤 값이라도 수용하게 됩니다.</li>
  <li>하지만, 함수가 자체적으로 로직을 실행하기 전에 검사하도록 한다면 demanding 접근 방법입니다.</li>
  <li>DRY 원칙에 의해, 이때도 검증 로직은 클라이언트에 두거나 함수 자체에 두어야 합니다.</li>
</ul>

<h3 id="사후조건postcondition">사후조건(postcondition)</h3>
<ul>
  <li>메서드 또는 함수가 반환된 후의 상태를 강제하는 계약의 일부입니다.</li>
  <li>사후조건 검증에 통과하고 클라이언트는 반환 객체를 아무 문제 없이 사용할 수 있어야 합니다.</li>
</ul>

<h2 id="방어적-프로그래밍">방어적 프로그래밍</h2>
<ul>
  <li>방어적 프로그래밍은 계약에 의한 디자인과 다른 접근방식을 따릅니다.</li>
  <li>계약에서 예외를 발생시키고 실패하게 되는 조건을 기술하는 대신, 코드의 모든 부분을 유효하지 않은 것으로부터 스스로 보호할 수 있도록 합니다.</li>
  <li>에러핸들링(예상할 수 있는 시나리오의 오류를 처리하는 방법)과 어썰션(발생하지 않아야 하는 오류를 처리하는 방법)을 사용합니다.</li>
</ul>

<h3 id="에러-핸들링">에러 핸들링</h3>
<ul>
  <li>예상되는 에러에 대해 실행할 수 있을지, 프로그램을 중단할지를 판단하기 위한 절차입니다.</li>
</ul>

<p><strong>값 대체</strong></p>
<ul>
  <li>일부 시나리오에서 오류에 의해 소프트웨어가 잘못된 값을 생성하거나 전체가 종료될 위험이 있는 경우, 결괏값을 다른 값으로 대체합니다.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">os</span>
<span class="n">os</span><span class="p">.</span><span class="nf">getenv</span><span class="p">(</span><span class="sh">"</span><span class="s">DBPORT</span><span class="sh">"</span><span class="p">,</span> <span class="mi">5432</span><span class="p">)</span> <span class="c1"># "DBPORT"가 env에 없는 경우 5432 반환
</span><span class="k">def</span> <span class="nf">connect_database</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="sh">"</span><span class="s">localhost</span><span class="sh">"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5432</span><span class="p">):</span>
    <span class="bp">...</span>
</code></pre></div>    </div>
  </li>
  <li>데이터가 누락될 경우 None 때문에 발생하게 되는 오류를 방지합니다.</li>
</ul>

<p><strong>예외 처리</strong></p>
<ul>
  <li>함수 호출 실패는 외부 컴포넌트 중 하나의 문제로 인한 것일 수 있습니다.</li>
  <li>함수는 심각한 오류에 대해 명확하고 분명하게 알려주어 적절하게 해결할 수 있도록 해야 합니다.</li>
  <li>예외가 많을수록 호출자는 함수에 대해 더 많은 것을 알아야 하므로, 캡슐화를 약화시킵니다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DataTransport</span><span class="p">:</span>
    <span class="n">retry_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">retry_n_times</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">connector</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_connector</span> <span class="o">=</span> <span class="n">connector</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection</span> <span class="o">=</span> <span class="bp">None</span>
      
    <span class="k">def</span> <span class="nf">deliver_event</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">connect</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">event</span><span class="p">.</span><span class="nf">decode</span><span class="p">()</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">연결 실패: %s</span><span class="sh">"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="nb">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">%r 잘못된 데이터 포함: %s</span><span class="sh">"</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>
    
    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">retry_n_times</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">_connector</span><span class="p">.</span><span class="nf">connect</span><span class="p">()</span>
            <span class="k">except</span> <span class="nb">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">%s: 새로운 연결 시도 %is</span><span class="sh">"</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">retry_threshold</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">connection</span>
        <span class="k">raise</span> <span class="nc">ConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">retry_n_times</span><span class="si">}</span><span class="s"> 번째 재시도 연결 실패</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">connection</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">deliver_event</code>의 경우, 두 가지의 예외상황이 발생할 수 있습니다. <code class="language-plaintext highlighter-rouge">connect</code> 메서드를 사용할 때 혹은 <code class="language-plaintext highlighter-rouge">decode()</code> 메서드를 사용할 때의 경우로, 구현을 수정할 필요가 있습니다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">connection_with_retry</span><span class="p">(</span><span class="n">connector</span><span class="p">,</span> <span class="n">retry_n_times</span><span class="p">,</span> <span class="n">retry_threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">retry_n_times</span><span class="p">):</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">connector</span><span class="p">.</span><span class="nf">connect</span><span class="p">()</span>
      <span class="k">except</span> <span class="nb">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
          <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">%s: 새로운 연결 시도 %is</span><span class="sh">"</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">retry_threshold</span><span class="p">)</span>
          <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">retry_threshold</span><span class="p">)</span>
      <span class="n">exc</span> <span class="o">=</span> <span class="nc">ConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">retry_n_times</span><span class="si">}</span><span class="s"> 번째 재시도 연결 실패</span><span class="sh">"</span><span class="p">)</span>
      <span class="n">logger</span><span class="p">.</span><span class="nf">exception</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
      <span class="k">raise</span> <span class="n">exc</span>

<span class="k">class</span> <span class="nc">DataTransport</span><span class="p">:</span>
    <span class="n">retry_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">retry_n_times</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">connector</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_connector</span> <span class="o">=</span> <span class="n">connector</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">deliver_event</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection</span> <span class="o">=</span> <span class="nf">connection_with_retry</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_connector</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">retry_n_times</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">retry_threshold</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">connection</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="nf">decode</span><span class="p">())</span>
        <span class="k">except</span> <span class="nb">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">%r 잘못된 데이터 포함: %s</span><span class="sh">"</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>
    <span class="bp">...</span>
</code></pre></div></div>
<ul>
  <li>연결과 연결 예외까지를 담당하는 <code class="language-plaintext highlighter-rouge">connection_with_retry</code> 메서드를 독립적으로 구현합니다.</li>
  <li>위와 같이 방식을 변경하면, 예외처리를 <code class="language-plaintext highlighter-rouge">deliver_event</code>에서 따로 관리할 필요가 없게 되고, 의도적으로 예외가 발생하도록 내버려 둘 수 있습니다.</li>
</ul>

<h3 id="예외처리시-주의사항">예외처리시 주의사항</h3>
<p><strong>Traceback 노출 금지</strong></p>
<ul>
  <li>예외 처리시 발생하는 오류가 전파되었을 때, 세부사항을 사용자에게 보이지 않도록 해야 합니다.</li>
  <li>파이썬에서의 traceback은 중요 정보들을 유출하게될 가능성이 있기 때문입니다.</li>
</ul>

<p><strong>비어있는 except 블록 사용 금지</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span><span class="p">:</span>
    <span class="nf">process_data</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</code></pre></div></div>
<ul>
  <li>파이썬의 철학은, “에러는 조용히 전달되어서는 안된다는 것”입니다. 위와 같은 방식은 코드를 숨기고 에러 수정을 어렵게 합니다.</li>
  <li><code class="language-plaintext highlighter-rouge">Exception</code>과 같이 광범위한 예외 보다는 <code class="language-plaintext highlighter-rouge">보다 구체적인 예외</code>를 사용해야합니다.</li>
</ul>

<p><strong>원본 예외 포함</strong></p>
<ul>
  <li>오류 처리 과정에서 다른 오류를 발생시키고 메시지를 변경하는 경우가 있을 수 있습니다.</li>
  <li>이 때, 원본의 예외를 포함하는 것이 좋습니다.
```python
class InternalDataError(Exception):
  “"”업무 도메인 데이터의 예외”””</li>
</ul>

<p>def process(data_dictionary, record_id):
    try:
        return data_dictionary[record_id]
    except KeyError as e:
      raise InternalDataError(“Record not present”) from e</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- 위와 같이, 기본 예외를 상속받아, 커스텀 예외로 처리하는 방식도 있습니다.

### 파이썬에서 어썰션 사용하기
- 절대로 일어나지 않아야하는 상황에서 사용됩니다. 따라서, assert 문이 작동하면, 소프트웨어에 결함이 있음을 의미합니다.
- 따라서, 프로그램을 중단해야할 가능성이 있는 오류로, 결함을 수정하기 위해 프로그램을 중지하는 것이 좋습니다.
```python
result = condition.holds()
assert result &gt; 0, "에러 {0}".format(result)
</code></pre></div></div>

<h2 id="관심사의-분리">관심사의 분리</h2>
<ul>
  <li>프로그램의 각 부분은 기능의 일부분(관심사)에 대해서만 책임을 지며, 나머지 부분에 대해서는 알 필요가 없습니다.</li>
  <li>소프트웨어의 관심사를 분리하는 목표는 파급 효과(한 지점의 변화가 전체로 전파되는 것)를 최소화하여 유지보수성을 향상시키는데 있습니다.</li>
</ul>

<h3 id="응집력">응집력</h3>
<ul>
  <li>객체는 작고 잘 정의된 목적을 가져야 하며, 가능하면 작아야 합니다.</li>
  <li>객체의 응집력이 높을수록 더 유용하고 재사용성이 높아지므로, 더 좋은 디자인입니다.</li>
</ul>

<h3 id="결합력">결합력</h3>
<ul>
  <li>두 개 이상의 객체가 서로 어떻게 의존하는지를 나타냅니다.</li>
  <li>객체 또는 메서드의 두 부분이 서로 너무 의존적이라면, 다음과 같은 결과를 가져옵니다.</li>
  <li>
    <ol>
      <li>낮은 재사용성: 어떤 함수가 특정 객체에 지나치게 의존하거나 너무 많은 파라미터를 가진다면, 해당 객체에 결합하게 됩니다.</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>파급효과: 너무 가깝게 붙어있게 되면, 두 부분 중 하나를 변경할 때 다른 부분에도 영향을 미칩니다.</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>낮은 수준의 추상화: 두 함수가 너무 가깝게 관련되어 있으면, 서로 다른 추상화 레벨에서 문제를 해결하기 어렵습니다.</li>
    </ol>
  </li>
</ul>

<h2 id="컴포지션과-상속">컴포지션과 상속</h2>

<h3 id="상속의-좋은-예시">상속의 좋은 예시</h3>
<ul>
  <li>public 메서드와 속성 인터페이스를 정의한 컴포넌트를 그대로 물려받으면서 추가 기능을 더하려고 하는 경우 및 특정 기능을 수정하는 경우에 좋습니다.</li>
  <li>예를 들어, <code class="language-plaintext highlighter-rouge">http.server</code> 패키지에서 <code class="language-plaintext highlighter-rouge">BaseHTTPRequsetHandler</code> 기본 클래스와, 이를 변경한 <code class="language-plaintext highlighter-rouge">SimpleHTTPRequestHandler</code>가 있습니다.</li>
  <li>예외처리를 담당하는 <code class="language-plaintext highlighter-rouge">Exception</code> 클래스의 경우, 상속을 사용하는 것이 좋습니다.</li>
</ul>

<h3 id="상속의-안티패턴">상속의 안티패턴</h3>
<ul>
  <li>도메인 문제를 해결하기 위해, 적절한 데이터 구조를 만든 후, 이를 사용하는 객체를 만들지 않고 데이터 구조(딕셔너리/셋/리스트 등) 자체를 객체로 만드는 경우입니다.</li>
  <li>또한, public 인터페이스를 통해 노출된 public 메서드를 사용하게 되기 때문에, 필요없는 메서드에도 접근할 수 있는 coupling에 대한 문제가 발생합니다.
```python
class TransactionPolicy(collections.UserDict):
  “"”잘못된 상속 예시”””
  def change_in_policy(self, customer_id, <strong>new_policy_data):
      self[customer_id].update(</strong>new_policy_data)</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- 올바른 해결책은 컴포지션을 사용하는 것입니다. `TransactionalPolicy` 자체가 딕셔너리가 되는 것이 아니라 딕셔너리를 활용하는 것입니다.
- 사전을 private 속성에 저장하고 `__getitem__()`으로 사전의 프록시를 만들고 나머지 필요한 public 메서드를 추가적으로 구현하는 것입니다.
```python
class TransactionPolicy:
    """컴포지션을 사용한 리팩토링 예시"""
    def __init__(self, policy_data, **extra_data):
        self._data = {**policy_data, **extra_data}
    
    def change_in_policy(self, customer_id, **new_policy_data):
        self._data[customer_id].update(**new_policy_data)

    def __getitem__(self, customer_id):
        return self._data[customer_id]
    
    def __len__(self):
        return len(self._data)
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">TransacctionalPolicy</code> 자체가 딕셔너리가 되는 것이 아닌, 딕셔너리를 활용하는 것입니다. 즉, 딕셔너리를 private 속성에 저장하고 <code class="language-plaintext highlighter-rouge">__getitem__()</code>으로 딕셔너리의 프록시를 생성합니다.</li>
  <li>이 방법은 개념적으로 정확하며, 현재 딕셔너리의 데이터 구조를 변경하더라도 인터페이스만 유지하면, 사용자는 영향을 받지 않습니다.</li>
</ul>

<h3 id="파이썬-다중상속">파이썬 다중상속</h3>
<ul>
  <li>파이썬은 다중상속을 지원하지만, 이를 잘못 사용하면 큰 문제를 초래할 수 있습니다.</li>
  <li>다중 상속의 올바른 해결책으로는 믹스인(mixin)을 활용한 디자인 패턴이 있습니다.</li>
</ul>

<p><strong>믹스인(mixin)</strong></p>
<ul>
  <li>믹스인은 코드를 재사용하기 위해, 일반적인 행동을 캡슐화한 기본 클래스입니다.</li>
  <li>
    <p>믹스인 클래스는 그 자체로는 유용하지 않으며, 대부분이 클래스에 정의된 메서드나 속성에 의존하기 때문에 확장에서는 동작하지 않습니다.
```python
class BaseTokenizer:
  def <strong>init</strong>(self, str_token):
      self.str_token = str_token</p>

    <p>def <strong>iter</strong>(self):
      yield from self.str_token.split(“-“)</p>
  </li>
</ul>

<p>class UpperIterableMixin:
  def <strong>iter</strong>(self):
      return map(str.upper, super().<strong>iter</strong>())</p>

<p>class Tokenizer(UpperIterableMixin, BaseTokenizer):
    pass</p>

<blockquote>
  <blockquote>
    <blockquote>
      <p>tk = BaseTokenizer(“28a2320b-fd3f-4627-9792-a2b38e3c46b0”)
list(tk)
[‘28a2320b’, ‘fd3f’, ‘4627’, ‘9792’, ‘a2b38e3c46b0’]
```</p>
      <ul>
        <li>위에서 mixin과 함께 <code class="language-plaintext highlighter-rouge">BaseTokenizer</code>를 사용한 <code class="language-plaintext highlighter-rouge">Tokenizer</code> 클래스의 경우, 일종의 데코레이터 역할을 합니다.</li>
        <li>믹스인에서 <code class="language-plaintext highlighter-rouge">__iter__</code>를 호출하고 다시 <code class="language-plaintext highlighter-rouge">super()</code>를 호출하여 <code class="language-plaintext highlighter-rouge">BaseTokenizer</code>에 위임합니다.</li>
      </ul>
    </blockquote>
  </blockquote>
</blockquote>

<h3 id="파이썬의-함수-인자-동작방식">파이썬의 함수 인자 동작방식</h3>
<ul>
  <li>파이썬의 첫 번째 규칙은 모든 인자가 passed by a value 된다는 것입니다. 따라서, 함수 인자에 있는 변수를 할당하고 나중에 사용합니다.</li>
  <li>함수의 인자가 mutable한지 immutable한지에 따라서 함수 내부에서 값이 의도치 않게 변형되는 경우가 발생할 수 있습니다.
<strong>가변인자</strong></li>
  <li>파이썬에서 가변인자를 사용하려면 해당 인자를 packing할 변수 이름 앞에 <code class="language-plaintext highlighter-rouge">*</code>를 붙입니다.
```python
    <h1 id="packing-예시">packing 예시</h1>
    <p>def f(first, second):
  print(first, second)</p>
  </li>
</ul>

<blockquote>
  <blockquote>
    <blockquote>
      <p>l = [1, 2]
f(*l)
1 2</p>
    </blockquote>
  </blockquote>
</blockquote>

<h1 id="unpacking-예시">unpacking 예시</h1>
<blockquote>
  <blockquote>
    <blockquote>
      <p>a, b = [1, 2]
print(a, b)
1 2
```</p>
      <ul>
        <li>인자를 딕셔너리로 패킹하려면 변수 이름 앞에 <code class="language-plaintext highlighter-rouge">**</code>를 붙입니다.
```python
def function(**kwargs):
  print(kwargs)</li>
      </ul>
    </blockquote>
  </blockquote>
</blockquote>

<blockquote>
  <blockquote>
    <blockquote>
      <p>function(key=”value”)
{‘key’: ‘value’}
```</p>
    </blockquote>
  </blockquote>
</blockquote>

  </div>
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/yamkant" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Yeham Kim. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
