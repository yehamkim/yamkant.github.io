<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[Architecture] Clean Architecture in Python - Yamâ€™s Dev Logs</title>
<meta name="description" content="https://github.com/Enforcer/clean-architecture">


  <meta name="author" content="Yeham Kim">
  
  <meta property="article:author" content="Yeham Kim">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Yam's Dev Logs">
<meta property="og:title" content="[Architecture] Clean Architecture in Python">
<meta property="og:url" content="http://localhost:4000/study/study-architecture-ddd/">


  <meta property="og:description" content="https://github.com/Enforcer/clean-architecture">







  <meta property="article:published_time" content="2023-11-07T00:05:07+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/study/study-architecture-ddd/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Yeham Kim",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Yam's Dev Logs Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--archive">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Yam's Dev Logs
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
<div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Yeham Kim</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>ì œí’ˆì„ ë§Œë“œëŠ” ê°œë°œìì…ë‹ˆë‹¤.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Seoul</span>
        </li>
      

      
        
          
            <li><a href="mailto:dev.yamkim@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/yamkant" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  

  
  <!--ì „ì²´ ê¸€ ìˆ˜ë¥¼ ì„¸ê¸° ìœ„í•œ ì—°ì‚°. sum ë³€ìˆ˜ì— ì „ì²´ ê¸€ ìˆ˜ ì €ì¥-->



<nav class="nav__list">
    <input id="ac-toc" name="accordion-toc" type="checkbox" />
    <label for="ac-toc">Toggle menu</label>
    <ul class="nav__items" id="category_tag_menu">
        <!--ì „ì²´ ê¸€ ìˆ˜-->
        <li style="font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;">
            ğŸ“‚ <span>Total Posts: 53</span>
        </li>
        <li>
            <!--span íƒœê·¸ë¡œ ì¹´í…Œê³ ë¦¬ë“¤ì„ í¬ê²Œ ë¶„ë¥˜ ex) C/C++/C#-->
            <span class="nav__sub-title">Django</span>
            <!--ul íƒœê·¸ë¡œ ê°™ì€ ì¹´í…Œê³ ë¦¬ë“¤ ëª¨ì•„ë‘” í˜ì´ì§€ë“¤ ë‚˜ì—´-->
            <ul>
                <!--Cpp ì¹´í…Œê³ ë¦¬ ê¸€ë“¤ì„ ëª¨ì•„ë‘” í˜ì´ì§€ì¸ /categories/cpp ì£¼ì†Œì˜ ê¸€ë¡œ ë§í¬ ì—°ê²°-->
                <!--category[1].size ë¡œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ë¥¼ ê°€ì§„ ê¸€ì˜ ê°œìˆ˜ í‘œì‹œ-->
                
                
                
                
                
                
                
                
                <li><a href="/categories/django-strategy" class="">Django Strategy (14)</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </ul>
            <ul>
                
                
                
                
                <li><a href="/categories/django-deep" class="">Django Deep (2)</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </ul>
            <span class="nav__sub-title">Server</span>
            <ul>
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/categories/server" class="">Server (3)</a></li>
                
                
                
                
                
                
                
                
                
                
            </ul>
            <span class="nav__sub-title">Study</span>
            <ul>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/categories/django-study" class="">Django Study (3)</a></li>
                
                
                
                
                
                
            </ul>
            <ul>
                
                
                
                
                
                
                <li><a href="/categories/study" class="">Study (23)</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </ul>
            <ul>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/categories/algorithm" class="">Algorithm (1)</a></li>
                
                
            </ul>
            <span class="nav__sub-title">Error Handle</span>
            <ul>
                
                
                <li><a href="/categories/error-async" class="">ë¹„ë™ê¸° ì²˜ë¦¬ (2)</a></li>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </ul>
            <span class="nav__sub-title">Database</span>
            <ul>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                <li><a href="/categories/database" class="">SQL (1)</a></li>
                
                
                
                
                
                
                
                
            </ul>
        </li>
    </ul>
</nav>
  

</div>


  <div class="archive">
    
      <h1 id="page-title" class="page__title">[Architecture] Clean Architecture in Python</h1>
    
    <p><a href="https://github.com/Enforcer/clean-architecture">https://github.com/Enforcer/clean-architecture</a></p>

<p><a href="https://velog.io/@jahoy/Python%EC%9C%BC%EB%A1%9C-Clean-Architecture-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0">Pythonìœ¼ë¡œ í´ë¦° ì•„í‚¤í…ì²˜ ì ìš©í•˜ê¸°</a></p>

<h2 id="ë„ë©”ì¸-ì£¼ë„-ì„¤ê³„-dddê°€-í•„ìš”í•˜ê²Œ-ëœ-ì´ìœ ">ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„ (DDD)ê°€ í•„ìš”í•˜ê²Œ ëœ ì´ìœ </h2>

<p><strong>ì¼ë°˜ì  ì„¤ê³„ ëª¨ë¸(CRUD ë°©ì‹)ì˜ ë¬¸ì œì </strong></p>

<ul>
  <li>ìƒëª…ì£¼ê¸°(Invariant Span)ê°€ single modelì„ ë„˜ì–´ì„œëŠ” ê²½ìš°ì— ë¡œì§ì´ ë³µì¡í•´ì§‘ë‹ˆë‹¤.</li>
  <li>codeê°€ ì„œë¡œ ê°•í•˜ê²Œ ê²°í•©(tightly coupled)ë˜ì–´ ìˆëŠ” ê²½ìš°, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ ë¯¸ë¦¬ ë§ì€ ì‘ì—…ì„ ì„¸íŒ…í•´ì•¼í•˜ëŠ” ê²½ìš°ê°€ ìƒê¹ë‹ˆë‹¤. (db ë¶ˆëŸ¬ì˜¤ê¸°, ì›¹ í”„ë ˆì„ì›Œí¬ ì½”ë“œ ì‹¤í–‰)</li>
  <li>ì¨ë“œíŒŒí‹° ì„œë¹„ìŠ¤ë“¤ê³¼ì˜ ê²°í•©ì´ ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì™¸ë¶€ ê²°ì œ ëª¨ë“ˆê³¼ ì²˜ìŒ ì½”ë“œë¥¼ ê²°í•©ì‹œì¼°ë‹¤ë©´, ë‹¤ë¥¸ ê²°ì œ ëª¨ë“ˆë¡œ ëŒ€ì²´í•˜ëŠ” ê²½ìš° ìˆ˜ì •í•˜ê¸° ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤.</li>
</ul>

<p><strong>Clean Architectureì˜ ì¥ì </strong></p>

<ul>
  <li>Frameworkì˜ ë…ë¦½ì„±: í”„ë ˆì„ì›Œí¬ë¥¼ ì—…ê·¸ë ˆì´ë“œ í•˜ê±°ë‚˜, êµì²´í•˜ê¸° ì‰¬ì›Œì§‘ë‹ˆë‹¤.</li>
  <li>Testaiblity: ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ unit testí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>UI/API, ì„œë“œíŒŒí‹° ëª¨ë“ˆ, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ë§¤ìš° ìœ ì—°í•˜ë©°, í™•ì¥ ê°€ëŠ¥ì´ ì‰½ìŠµë‹ˆë‹¤. (CQRS, Event-Sourcing, DDD ë°©ì‹ì„ í•„ìš”ë¡œ í•œë‹¤ë©´ ì ìš© ê°€ëŠ¥)</li>
</ul>

<p><strong>ë¹„ì¦ˆë‹ˆìŠ¤ ë£°</strong></p>

<ul>
  <li>ì»´í“¨í„° í”„ë¡œê·¸ë¨ì—ì„œ ì‹¤ì„¸ê³„ì˜ ê·œì¹™ì— ë”°ë¼ ë°ì´í„°ë¥¼ ìƒì„±, í‘œì‹œ, ì €ì¥, ë³€ê²½í•˜ëŠ” ë¶€ë¶„ì„ ì¼ì»¬ìœ¼ë©°, ë„ë©”ì¸ ë¡œì§ì´ë¼ê³ ë„ ë§í•©ë‹ˆë‹¤.</li>
  <li>ìœ ì €ì˜ ì…ë ¥(UI)ê³¼ DB ì‚¬ì´ì—ì„œ ë°œìƒí•œ ì •ë³´ êµí™˜ì„ ìœ„í•œ íŠ¹ì • ì•Œê³ ë¦¬ì¦˜ì´ë‚˜ ê·œì¹™ì´ ì •ì˜ë˜ë©°, ê³ ê°ì˜ ìš”êµ¬ì— ë”°ë¼ ë³€ê²½ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>

<p><strong>ì‹œìŠ¤í…œ ì•„í‚¤í…ì³</strong></p>

<ul>
  <li>ì‹œìŠ¤í…œì˜ êµ¬ì¡°(structure), í–‰ìœ„(behavior), ë·°(views)ë¥¼ ì •ì˜í•˜ëŠ” ê°œë… ëª¨ë¸ì…ë‹ˆë‹¤.</li>
  <li>ì‹œìŠ¤í…œì˜ ëª©ì ì„ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ê° ì»´í¬ë„ŒíŠ¸ê°€ ì–´ë–»ê²Œ ìƒí˜¸ì‘ìš©í•˜ë©°, ì–´ë–»ê²Œ ì •ë³´ê°€ êµí™˜ ë˜ëŠ”ì§€ ì„¤ëª…í•©ë‹ˆë‹¤.</li>
</ul>

<h2 id="layers-of-clean-architecture"><strong>Layers of Clean Architecture</strong></h2>

<ul>
  <li>External World: DB, API, Networkë“± ì½”ë“œì˜ ë°”ê¹¥ìª½ ì™¸ë¶€ ì„¸ê³„ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
  <li>
    <p>Infrastructure: DBì™€ APIì™€ ê°™ì€ ê²ƒë“¤ì— ëŒ€í•œ adapterì˜ ì—­í• ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>

    <p><strong>Adapters</strong></p>

    <ul>
      <li>Domainê³¼ Infrastructure ì‚¬ì´ì˜ ë²ˆì—­ê¸° ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</li>
      <li>GUIì˜ MVC ì•„í‚¤í…ì²˜ë¥¼ ì™„ì „íˆ ë‚´í¬í•©ë‹ˆë‹¤. GUI(í´ë¼ì´ì–¸íŠ¸)ì˜ ë°ì´í„°ë¥¼ ë°›ì•„ Use caseë“¤ê³¼ Entityë“¤ì—ê²Œ í¸ë¦¬í•œ í˜•íƒœë¡œ repackage í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>Application
    <ul>
      <li>Use Case: í•˜ë‚˜ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ìœ¼ë¡œ, ìœ ì € í•˜ë‚˜ì˜ ì•¡ì…˜ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ì…ì°°í•˜ê¸°, ì…ì°° ì·¨ì†Œí•˜ê¸° ë“±ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. (interfaceì˜ êµ¬ì²´í™” ë²„ì „ìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)</li>
      <li>Interface: ì¶”ìƒí™”ëœ use caseì™€ infrastructureì„ ì¶”ìƒí™”í•©ë‹ˆë‹¤.</li>
    </ul>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1"># application/interfaces/email_sender.py
</span>  <span class="kn">import</span> <span class="n">abc</span>
  <span class="k">class</span> <span class="nc">EmailSender</span><span class="p">(</span><span class="n">abc</span><span class="p">.</span><span class="n">ABC</span><span class="p">):</span>
         <span class="nd">@abc.abstractmethod</span>
         <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">EmailMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
             <span class="k">pass</span>
  <span class="c1"># infrastructure/adapters/email_sender.py
</span>  <span class="kn">import</span> <span class="n">smtplib</span>
  <span class="kn">from</span> <span class="n">application.interfaces.email_sender</span> <span class="kn">import</span> <span class="n">EmailSender</span>
  <span class="k">class</span> <span class="nc">LocalhostEmailSender</span><span class="p">(</span><span class="n">EmailSender</span><span class="p">):</span>
      <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">EmailMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
          <span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="p">.</span><span class="nc">SMTP</span><span class="p">(</span><span class="sh">'</span><span class="s">localhost</span><span class="sh">'</span><span class="p">,</span> <span class="mi">1025</span><span class="p">)</span>
          <span class="c1"># etc
</span></code></pre></div>    </div>
  </li>
  <li>Domain: identityë¥¼ ê°€ì§„ Entityë¡œ êµ¬ì„±ë˜ë©°, ë¹„ì¦ˆë‹ˆìŠ¤ ë£°ì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤</li>
</ul>

<h3 id="í´ë¦°-ì•„í‚¤í…ì³ì˜-ê³„ì¸µê³¼-ë°©í–¥ì„±">í´ë¦° ì•„í‚¤í…ì³ì˜ ê³„ì¸µê³¼ ë°©í–¥ì„±</h3>

<ul>
  <li>
    <p>External World â†’ Infrastructure â†’ Application â†’ Domainì˜ ë°©í–¥ì„±ì„ ê°€ì§‘ë‹ˆë‹¤.</p>
  </li>
  <li><strong>Dependency Rule</strong>: í™”ì‚´í‘œ ë°©í–¥ìœ¼ë¡œ ì˜ì¡´ì„±ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
    <ul>
      <li>Applicationì€ Domainì„ ì‚¬ìš©í•´ë„, Domainì€ Applicationì„ ì‚¬ìš©í•˜ì§€ ëª»í•©ë‹ˆë‹¤.</li>
      <li>Infrastructureì€ Applicationì„ ì‚¬ìš©í•´ë„, Applicationì€ Infrastructureì„ ì‚¬ìš©í•˜ì§€ ëª»í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li><strong>Business Rules, Processes</strong>: Application Layerì™€ Domain Layer ìƒì—ì„œ ì´ë£¨ì–´ì§€ë©°, External Worldë¥¼ ì „í˜€ ëª¨ë¥´ëŠ” ìƒíƒœë¡œ ì‰½ê²Œ Buisiness Logicì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li><strong>Boundary</strong>: ì—¬ëŸ¬ê°œì˜ Interfaceë“¤ë¡œ ì •ì˜ ë©ë‹ˆë‹¤. ëª¨ë“  detailì€ boundary ë’¤ì— ìˆ¨ì–´ìˆìŠµë‹ˆë‹¤.</li>
  <li><strong>Input DTO, Output DTO, Input Boundary</strong>: Application Layer ì•ˆì— Detailì„ ìˆ¨ê¸°ëŠ” Boundaryë¥¼ í˜•ì„±í•©ë‹ˆë‹¤.
    <ul>
      <li>Input DTO: Boundaryì— ì§„ì…í•  ìˆ˜ ìˆëŠ” input argument(Request)ì…ë‹ˆë‹¤.</li>
      <li>Output DTO: Response</li>
      <li>Input Boundary: Use Caseë“¤ì„ ì¶”ìƒí™”í•œ Interfaceì…ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PlacingBidInputDto</span><span class="p">:</span>
    <span class="n">bidder_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">auction_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">amount</span><span class="p">:</span> <span class="n">Decimal</span>   
    
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PlacingBidOutputDto</span><span class="p">:</span>
    <span class="n">is_winning</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">current_price</span><span class="p">:</span> <span class="n">Decimal</span>                                   
    
<span class="k">class</span> <span class="nc">PlacingBidInputBoundary</span><span class="p">:</span>
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">PlacingBidInputDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
</code></pre></div></div>

<h2 id="control-flow-in-architecture">Control Flow in Architecture</h2>

<ol>
  <li>Controller: HTTP ìš”ì²­ì„ repackí•˜ì—¬ Input DTOë¡œ ë³´ë‚´ë©°, ì´ëŠ” Input Boundary(Use Caseì˜ ì¸í„°í˜ì´ìŠ¤)ì˜ inputìœ¼ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.</li>
  <li>Input Boundary: Input DTOë¥¼ ì´ìš©í•˜ì—¬ Input DTOì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë©°, í•„ìš”í•œ Entityë“¤ì„ ë°ì´í„° ì•¡ì„¸ìŠ¤ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ DBë¡œë¶€í„° fetchí•©ë‹ˆë‹¤.</li>
  <li>Entity: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ë°ì´í„° ì•¡ì„¸ìŠ¤ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ë³€ê²½ ì‚¬í•­ì„ ì €ì¥í•©ë‹ˆë‹¤.</li>
  <li>Use Case: Output Boundary(Presenterì˜ ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ í•¨)ì— Output DTOë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤. ì´ ë•Œ, PresenterëŠ” Output DTOì˜ ë°ì´í„°ë¥¼ reformatí•˜ì—¬ Viewì— ìµœì¢…ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.</li>
</ol>

<ul>
  <li>Input DTO, Input Boundary, Output Boundary, OutputDto, UseCase, Data Access InterfaceëŠ” Application Layerì— ì†í•©ë‹ˆë‹¤.</li>
  <li>EntityëŠ” Domain Layerì— ì†í•©ë‹ˆë‹¤.</li>
</ul>

<h3 id="sequence-diagram">Sequence diagram</h3>

<h4 id="ë¹„ì¦ˆë‹ˆìŠ¤-ìš”êµ¬ì‚¬í•­-ì˜ˆì‹œ">ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ (ì˜ˆì‹œ)</h4>

<ul>
  <li>ì…ì°°ìë“¤ì€ ê²½ë§¤ì— ì…ì°°í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ê²½ë§¤ì—ëŠ” ëª¨ë“  ì…ì°°ìê°€ ë³¼ ìˆ˜ ìˆëŠ” ì‹¤ì‹œê°„ ê°€ê²©ì´ ìˆë‹¤.
    <ul>
      <li>í˜„ì¬ ê°€ê²©ì€ ê°€ì¥ ë‚®ì€ ë‚™ì°°ê°€ì˜ ì–‘ì— ë”°ë¼ ê²°ì •ëœë‹¤.</li>
      <li>ìŠ¹ìê°€ ë˜ë ¤ë©´, í˜„ì¬ ê°€ê²©ë³´ë‹¤ ë†’ì€ ê°€ê²©ì„ ì œê³µí•´ì•¼ í•œë‹¤.</li>
    </ul>
  </li>
  <li>ê²½ë§¤ì—ëŠ” ì‹œì‘ ê°€ê²©ì´ ìˆìœ¼ë©°, ì‹œì‘ ê°€ê²©ë³´ë‹¤ ë‚®ì€ ê¸ˆì•¡ì˜ ìƒˆë¡œìš´ ì…ì°°ì€ ìˆ˜ë½ë˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>

<h4 id="input-boundary-input-dto">Input Boundary, Input DTO</h4>

<p><a href="https://velog.io/@sawol/%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%B4%EB%9E%98%EC%8A%A4dataclasses">ë°ì´í„° í´ë˜ìŠ¤(dataclasses)</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PlacingBidInputDto</span><span class="p">:</span>
    <span class="n">bidder_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">auction_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">amount</span><span class="p">:</span> <span class="n">Decimal</span>
 
<span class="k">class</span> <span class="nc">PlacingBidInputBoundary</span><span class="p">(</span><span class="n">abc</span><span class="p">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_dto</span><span class="p">:</span> <span class="n">PlacingBidInputDto</span><span class="p">,</span> 
    		<span class="n">presenter</span><span class="p">:</span> <span class="n">PlacingBidOutputBoundary</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
	<span class="k">pass</span>
</code></pre></div></div>

<ul>
  <li>ì…ë ¥ ë°ì´í„°ì™€ ê´€ë ¨ëœ ë¶€ë¶„ì…ë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@dataclass</code>ëŠ” í´ë˜ìŠ¤ ë‚´ë¶€ì˜ í•„ë“œë“¤ì˜ í˜•ì‹ì„ ì •ì˜í•¨ê³¼ ë™ì‹œì—, ë§¤ì§ ë©”ì„œë“œ(<strong>init</strong>, <strong>repr</strong> ë“±)ì„ ê¸°ë³¸ì ìœ¼ë¡œ ì„¸íŒ…í•´ì£¼ì–´ í¸ë¦¬í•©ë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">@abc.abstractmethod</code>ëŠ” í•´ë‹¹ ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” êµ¬ì²´ í´ë˜ìŠ¤ì—ì„œ ë°˜ë“œì‹œ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë„ë¡ ê°•ì œí•˜ëŠ” ì• ë…¸í…Œì´ì…˜ì…ë‹ˆë‹¤.</li>
  <li>Input BoundaryëŠ” Use Caseë¥¼ ì¶”ìƒí™”í•©ë‹ˆë‹¤.</li>
</ul>

<h4 id="use-case">Use Case</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">PlacingBidUseCase</span><span class="p">(</span><span class="n">PlacingBidInputBoundary</span><span class="p">):</span>
<span class="sh">"""</span><span class="s">
1. Auction entityë¥¼ data accessë¥¼ í†µí•´ retrieve
2. entityì˜ place bid ë©”ì†Œë“œ í˜¸ì¶œ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰)
3. Command ì—­í• : ì—…ë°ì´íŠ¸ ìƒíƒœë³€ê²½ ë° ì €ì¥, return ê°’ ì—†ëŠ” ê²ƒì´ íŠ¹ì§•
4. Output DTO ìƒì„±
5. Output DTOë¥¼ Output Boundaryì— ì „ë‹¬
</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_access</span><span class="p">:</span> <span class="n">AuctionsDataAccess</span><span class="p">,</span> <span class="n">output_boundary</span><span class="p">:</span>
       <span class="n">PlacingBidOutputBoundary</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_data_access</span> <span class="o">=</span> <span class="n">data_access</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_output_boundary</span> <span class="o">=</span> <span class="n">output_boundary</span>
        
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_dto</span><span class="p">:</span> <span class="n">PlacingBidInputDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">auction</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">_data_access</span><span class="p">.</span><span class="nf">get_auction</span><span class="p">(</span><span class="n">input_dto</span><span class="p">.</span><span class="n">auction_id</span><span class="p">)</span>
        <span class="n">auction</span><span class="p">.</span><span class="nf">place_bid</span><span class="p">(</span><span class="n">input_dto</span><span class="p">.</span><span class="n">bidder_id</span><span class="p">,</span> <span class="n">input_dto</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_data_access</span><span class="p">.</span><span class="nf">save_auction</span><span class="p">(</span><span class="n">auction</span><span class="p">)</span>
        <span class="n">output_dto</span> <span class="o">=</span> <span class="nc">PlacingBidOutputDto</span><span class="p">(</span>
            <span class="n">input_dto</span><span class="p">.</span><span class="n">bidder_id</span> <span class="ow">in</span> <span class="n">auction</span><span class="p">.</span><span class="n">winners</span><span class="p">,</span> <span class="n">auction</span><span class="p">.</span><span class="n">current_price</span>
        <span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_output_boundary</span><span class="p">.</span><span class="nf">present</span><span class="p">(</span><span class="n">output_dto</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ë‹´ê¸´ ë¶€ë¶„ì…ë‹ˆë‹¤.</li>
  <li>interfaceë“¤(Higher Layer)ê³¼ ì½”ë“œë¥¼ êµ¬ì„±í•˜ê³  ê²°í•©í•©ë‹ˆë‹¤.</li>
  <li>ì•ì„œ ë§í•œ ë°©í–¥ì„±ì— ë”°ë¼, ë’·ë‹¨ì—ì„œ ì´ë£¨ì–´ì§€ëŠ” concrete Implementationì€ ëª¨ë¦…ë‹ˆë‹¤.
(Dependency Injectionì„ í†µí•´ Mapping í•´ì£¼ê²Œ ë  ê²ƒì´ê¸° ë•Œë¬¸)</li>
  <li>PlacingBidUseCaseëŠ” Use Caseë¡œ, Input Boundaryë¥¼ êµ¬ì²´í™”í•©ë‹ˆë‹¤.</li>
</ul>

<h4 id="output-boundary-output-dto">Output Boundary, Output DTO</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PlacingBidOutputDto</span><span class="p">:</span>
    <span class="n">is_winning</span><span class="p">:</span> <span class="nb">bool</span>
	<span class="n">current_price</span><span class="p">:</span> <span class="n">Decimal</span>

<span class="k">class</span> <span class="nc">PlacingBidOutputBoundary</span><span class="p">(</span><span class="n">abc</span><span class="p">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">present</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">output_dto</span><span class="p">:</span> <span class="n">PlacingBidOutputDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    	<span class="k">pass</span>
        
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_presented_data</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    	<span class="k">pass</span>
</code></pre></div></div>

<ul>
  <li>Output BoundaryëŠ” Presenterë¥¼ ì¶”ìƒí™”í•©ë‹ˆë‹¤.</li>
</ul>

<h4 id="presenter">Presenter</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Presenter: ìµœì¢…ì ìœ¼ë¡œ viewì— ë³´ì—¬ì¤„ dataë¥¼ reformat ì‹œí‚¤ëŠ” ì—­í• 
</span><span class="k">class</span> <span class="nc">PlacingBidWebPresenter</span><span class="p">(</span><span class="n">PlacingBidOutputBoundary</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">present</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">output_dto</span><span class="p">:</span> <span class="n">PlacingBidOutputDto</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">_formatted_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">current_price</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">$</span><span class="si">{</span><span class="n">output_dto</span><span class="p">.</span><span class="n">current_price</span><span class="p">.</span><span class="nf">quantize</span><span class="p">(</span><span class="sh">"</span><span class="s">.01</span><span class="sh">"</span><span class="p">)</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">is_winning</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Congratulations!</span><span class="sh">'</span> <span class="k">if</span> <span class="n">output_dto</span><span class="p">.</span><span class="n">is_winning</span> <span class="k">else</span> <span class="sh">'</span><span class="s">:(</span><span class="sh">'</span>
        <span class="p">}</span>
        
    <span class="k">def</span> <span class="nf">get_presented_data</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">_formatted_data</span>
</code></pre></div></div>

<ul>
  <li>PresenterëŠ” Viewì— ìµœì¢… ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ê²Œ ë©ë‹ˆë‹¤.</li>
</ul>

<h3 id="inject-ëª¨ë“ˆì„-ì‚¬ìš©í•œ-dependency-rule-ìƒì„±">inject ëª¨ë“ˆì„ ì‚¬ìš©í•œ Dependency Rule ìƒì„±</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">inject</span>

<span class="k">def</span> <span class="nf">di_config</span><span class="p">(</span><span class="n">binder</span><span class="p">:</span> <span class="n">inject</span><span class="p">.</span><span class="n">Binder</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">binder</span><span class="p">.</span><span class="nf">bind</span><span class="p">(</span><span class="n">AuctionsDataAccess</span><span class="p">,</span> <span class="nc">DbAuctionsDataAccess</span><span class="p">())</span>
    <span class="n">binder</span><span class="p">.</span><span class="nf">bind_to_provider</span><span class="p">(</span><span class="n">PlacingBidOutputBoundary</span><span class="p">,</span> <span class="n">PlacingBidWebPresenter</span><span class="p">)</span>

<span class="n">inject</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">di_config</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">di_config</code>: ì¶”ìƒ í´ë˜ìŠ¤ì™€ êµ¬í˜„ì²´ë¥¼ ì—°ê²°í•˜ì—¬ Dependency Ruleì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´, ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•  ë•Œ íŠ¹ì • Implementationì´ ì‚¬ìš©ë˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">AuctionsDataAccess</span><span class="p">(</span><span class="n">abc</span><span class="p">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">auction_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">pass</span>
        
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">auction</span><span class="p">:</span> <span class="n">Auction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    	<span class="k">pass</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Data Access</code>: ë°ì´í„°ë² ì´ìŠ¤ì˜ ì¸í„°í˜ì´ìŠ¤ ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Bid</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">bidder_id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">amount</span><span class="p">:</span> <span class="n">Decimal</span>

<span class="c1"># Entities - Auction
</span><span class="k">class</span> <span class="nc">Auction</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">starting_price</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">,</span> <span class="n">bids</span><span class="p">:</span> <span class="n">typing</span><span class="p">.</span><span class="n">List</span><span class="p">[</span><span class="n">Bid</span><span class="p">]):</span>
       <span class="n">self</span><span class="p">.</span><span class="nb">id</span> <span class="o">=</span> <span class="nb">id</span>
       <span class="n">self</span><span class="p">.</span><span class="n">starting_price</span> <span class="o">=</span> <span class="n">starting_price</span>
       <span class="n">self</span><span class="p">.</span><span class="n">bids</span> <span class="o">=</span> <span class="n">bids</span>
       
    <span class="k">def</span> <span class="nf">place_bid</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">amount</span><span class="p">:</span> <span class="n">Decimal</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
       <span class="k">pass</span>
       
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">current_price</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Decimal</span><span class="p">:</span>
       <span class="k">pass</span>
       
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">winners</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="p">.</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
       <span class="k">pass</span>
</code></pre></div></div>

<h2 id="clean-architecture-ë³€í˜•í• -ìˆ˜-ìˆëŠ”-í˜•íƒœ-ì†Œê°œ">Clean Architecture ë³€í˜•í•  ìˆ˜ ìˆëŠ” í˜•íƒœ ì†Œê°œ</h2>

<h3 id="presenterì—ì„œ-get-í•¨ìˆ˜-ì‚¬ìš©">Presenterì—ì„œ get í•¨ìˆ˜ ì‚¬ìš©</h3>

<ul>
  <li>Viewì˜ return ê°’ìœ¼ë¡œ Presenterì˜ í…œí”Œë¦¿ì„ ë°˜í™˜í•˜ë¯€ë¡œì¨, Presenterê°€ ë Œë”ë§ ì—­í• ì„ ë‹´ë‹¹í•˜ë„ë¡ í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
	<span class="k">return</span> <span class="nc">HttpResponse</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Hello, world!</span><span class="sh">'</span><span class="p">)</span>
<span class="o">---</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
	<span class="bp">...</span>
	<span class="k">return</span> <span class="n">presenter</span><span class="p">.</span><span class="nf">get_html_response</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="cqrs-ë°©ì‹">CQRS ë°©ì‹</h3>

<ul>
  <li>Output DTOì™€ Output Boundary ëŒ€ì‹ , CQRS ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤.</li>
</ul>

<h3 id="input-boundary-ì œê±°ê°€ëŠ¥">Input Boundary ì œê±°ê°€ëŠ¥</h3>

<h2 id="user-case-ëŒ€ì•ˆ">User Case ëŒ€ì•ˆ</h2>

<h3 id="facade-íŒ¨í„´">Facade íŒ¨í„´</h3>

<ul>
  <li>User Caseê°€ ë³µì¡í•˜ì§€ ì•Šì€ í˜•íƒœë¼ë©´ Facade íŒ¨í„´ì„ ì‚¬ìš©í•˜ì—¬ ë””ìì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ìˆœì°¨ì ì¸ ë©”ì„œë“œë“¤ì„ single function ì•ˆì— ë„£ì–´ì„œ êµ¬í˜„í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.</li>
  <li>get an Entity using Data Access Interface, call an Entityâ€™s method, then save it back.</li>
</ul>

<h3 id="mediatorcommand-bus">Mediator(Command Bus)</h3>

<ul>
  <li>Output DTOë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, Input DTOë¥¼ CQRSì˜ Commandsë¡œ ëŒ€ì²´í•˜ê³ , Command Busë¼ê³  ë¶ˆë¦¬ëŠ” Mediatorë¥¼ ë„ì…í•˜ëŠ” ê²ƒë„ ì¢‹ì€ ëŒ€ì•ˆì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ì´ ë•Œ, Use CaseëŠ” Command Handlerê°€ ë˜ë©°, CommandëŠ” DTOê°€ ë©ë‹ˆë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">placing_bid_view</span><span class="p">(...)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
	<span class="n">command</span> <span class="o">=</span> <span class="nc">PlaceBid</span><span class="p">(..)</span>
	<span class="n">command_bus</span><span class="p">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>Handlerë¡œë¶€í„° ì™„ì „íˆ decouple ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, Command classesì™€ Command Busë§Œ ì•Œê³  ìˆìœ¼ë©´ ë©ë‹ˆë‹¤.</li>
</ul>

<h2 id="dependency-injection">Dependency Injection</h2>

<ul>
  <li>ì¶”ìƒí™”ì— ëŒ€ì‘ë˜ëŠ” ì–´ë–¤ Implementationì„ mapping í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CreditCardPaymentGateway</span><span class="p">(</span><span class="n">PaymentGateway</span><span class="p">):</span>
	<span class="k">pass</span>

<span class="c1"># tight coupling (implementationì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œ ê²½ìš°)
</span><span class="k">class</span> <span class="nc">Order</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">finalise</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">payment_gateway</span> <span class="o">=</span> <span class="nc">CreditCardPaymentGateway</span><span class="p">(</span>
			<span class="n">settings</span><span class="p">.</span><span class="n">payment</span><span class="p">[</span><span class="sh">'</span><span class="s">url</span><span class="sh">'</span><span class="p">],</span> <span class="n">settings</span><span class="p">.</span><span class="n">payment</span><span class="p">[</span><span class="sh">'</span><span class="s">credentials</span><span class="sh">'</span><span class="p">]</span>
		<span class="p">)</span>
		<span class="n">payment_gateway</span><span class="p">.</span><span class="nf">pay</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">total</span><span class="p">)</span>

<span class="c1"># loose coupling (payment_gatewayë¡œ ì¶”ìƒí™”í•œ classë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°)
</span><span class="k">class</span> <span class="nc">Order</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">payment_gateway</span><span class="p">:</span> <span class="n">PaymentGateway</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">self</span><span class="p">.</span><span class="n">_payment_gateway</span> <span class="o">=</span> <span class="n">PaymentGateway</span>
	<span class="k">def</span> <span class="nf">finalise</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">self</span><span class="p">.</span><span class="n">_payment_gateway</span><span class="p">.</span><span class="nf">pay</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">total</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>Configurationì„ í†µí•´ Dependency Injectionì„ ê´€ë¦¬í•˜ë©´, ifë¬¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.</li>
</ul>

<h2 id="cqrs">CQRS</h2>

<ul>
  <li>ì‹œìŠ¤í…œì˜ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ì½”ë“œì™€ ìƒíƒœ ë³€ê²½ì—†ì´ dataë¥¼ readí•˜ëŠ” ì½”ë“œë¥¼ ë¶„ë¦¬í•©ë‹ˆë‹¤.</li>
  <li>CQRSëŠ” writingì„ ìœ„í•´ ì •ê·œí™”ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©ëŠ” ê²ƒê³¼, ì£¼ê¸°ì ì¸ ê°„ê²©ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¥¼ ìœ ì§€í•˜ëŠ” ë°ì´í„° ë©”ì»¤ë‹ˆì¦˜ì„ ì¿¼ë§í•˜ê¸° ìœ„í•´ ë¹„ì •ê·œí™”ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ í—ˆìš©í•©ë‹ˆë‹¤.</li>
  <li>Event Sourcing ë°©ì‹ê³¼ì˜ ê¶í•©ì´ ì¢‹ìŠµë‹ˆë‹¤.</li>
</ul>

<h3 id="commands"><strong>Commands</strong></h3>

<ul>
  <li>ì‹œìŠ¤í…œì˜ ìƒíƒœë¥¼ ë³€í™”ì‹œí‚µë‹ˆë‹¤.</li>
  <li>Business requirements ë³€í™”ì— ì˜í–¥ì„ ë§ì´ ë°›ìŠµë‹ˆë‹¤.</li>
  <li>ì‹¤í–‰ ìˆœì„œê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.</li>
</ul>

<h3 id="queries"><strong>Queries</strong></h3>

<ul>
  <li>ì‹œìŠ¤í…œì˜ ìƒíƒœë¥¼ ë³€ê²½í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, ê°„ë‹¨í•˜ê³  ì•ˆì „í•©ë‹ˆë‹¤.</li>
</ul>

<p><img src="Clean%20Architecture%20in%20Python%2002f338c7dcc741178f7b7df9c3804592/Untitled%204.png" alt="Untitled" /></p>

<h3 id="command"><strong>Command</strong></h3>

<ul>
  <li>CommandsëŠ” DTOì—­í• ì„ í•˜ë©° Command Handlersì— ì˜í•´ ì‹¤í–‰ë©ë‹ˆë‹¤.</li>
  <li>ê°œë°œìëŠ” applicationì—ì„œ serviceë“¤ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ Command Handlerì˜ ì¡´ì¬ë¥¼ ì•Œ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</li>
  <li>
    <p>Use Caseë¥¼ sending a Commandë¡œ ëŒ€ì²´í•´ì„œ ìƒê°í•©ë‹ˆë‹¤.</p>

    <p>Command(DTO) - Command Bus - Command Handler</p>
  </li>
</ul>

<h3 id="query"><strong>Query</strong></h3>

<h4 id="queryë¥¼-dtoë¡œ-ë‹¤ë£¨ëŠ”-ë°©ë²•">Queryë¥¼ DTOë¡œ ë‹¤ë£¨ëŠ” ë°©ë²•</h4>

<ul>
  <li>Commandë¥¼ ë‹¤ë£¨ëŠ” ë°©ì‹ê³¼ ë™ì¼í•˜ê²Œ ë™ì‘í•©ë‹ˆë‹¤. ê°ê°ì˜ ì¿¼ë¦¬ë¥¼ single class (DTO) í˜•íƒœë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
  <li>ê°œë°œìëŠ” Query Handlerì˜ ì¡´ì¬ë¥¼ ì•Œ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</li>
  <li>
    <p>Query classëŠ” Application Layerì— ì†í•˜ê³ , Query HandlerëŠ” Infrastructure layerì— ì†í•©ë‹ˆë‹¤.</p>

    <p>Query(DTO) - Query Bus - Query Handler</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">GetListOfDeliveryAddresses</span><span class="p">(</span><span class="n">Query</span><span class="p">):</span>
	<span class="n">Dto</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="n">DeliveryAddress</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">self</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">user_id</span>
	<span class="k">def</span> <span class="nf">query_handler</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="n">GetListOfDeliveryAddreses</span><span class="p">)</span>
			<span class="o">-&gt;</span> <span class="n">GetListOfDeliveryAddresses</span><span class="p">.</span><span class="n">Dto</span><span class="p">:</span>
		<span class="bp">...</span>

<span class="c1"># using via QueryBus
</span><span class="n">query</span> <span class="o">=</span> <span class="nc">GetListOfDeliveryAddresses</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">query_bus</span><span class="p">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="queriesë¥¼-ë¶„ë¦¬ëœ-í´ë˜ìŠ¤ë“¤ë¡œ-ë‹¤ë£¨ëŠ”-ë°©ë²•">Queriesë¥¼ ë¶„ë¦¬ëœ í´ë˜ìŠ¤ë“¤ë¡œ ë‹¤ë£¨ëŠ” ë°©ë²•</h4>

<ul>
  <li>Query Bus, Query Handlerë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ê°ê°ì˜ QueryëŠ” Abstract classë¡œ Application Layerì— ìˆë„ë¡ í•©ë‹ˆë‹¤.</li>
  <li>concrete implementationì€ Infrastructure Layerì— ìœ„ì¹˜í•˜ë„ë¡ í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># somewhere in Application Layer
</span><span class="k">class</span> <span class="nc">GettingListOfDeliveryAddresses</span><span class="p">(</span><span class="n">Query</span><span class="p">):</span>
	<span class="n">Dto</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="n">DeliveryAddress</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
		<span class="n">self</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">user_id</span>
	<span class="nd">@abc.abstractmethod</span>
	<span class="k">def</span> <span class="nf">excute</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dto</span><span class="p">:</span>
		<span class="k">pass</span>

<span class="c1"># in Infrastructure layer
</span><span class="k">class</span> <span class="nc">SqlGettingListOfDeliveryAddresses</span><span class="p">(</span><span class="n">GettingListOfDeliveryAddresses</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">excute</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GettingListOfDeliveryAddresses</span><span class="p">.</span><span class="n">Dto</span><span class="p">:</span>
		<span class="n">models</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">session</span><span class="p">.</span><span class="nf">query</span><span class="p">(</span><span class="n">Address</span><span class="p">).</span><span class="nf">filter</span><span class="p">(</span>
			<span class="p">(</span><span class="n">Address</span><span class="p">.</span><span class="nb">type</span> <span class="o">==</span> <span class="n">Address</span><span class="p">.</span><span class="n">DELIVERY</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">Address</span><span class="p">.</span><span class="n">user_id</span> <span class="o">==</span> <span class="n">self</span><span class="p">.</span><span class="n">user_id</span><span class="p">)</span>
		<span class="p">)</span>
		<span class="k">return</span> <span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="nf">_to_dto</span><span class="p">(</span><span class="n">model</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">]</span>

<span class="c1"># ì„¤ì •íŒŒì¼ì—ì„œ Sql ê´€ë ¨ ì„¤ì •ìœ¼ë¡œ ë°”ì¸ë“œ í•´ì¤ë‹ˆë‹¤.
</span><span class="nd">@inject</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">Config</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">binder</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
	<span class="n">binder</span><span class="p">.</span><span class="nf">bind</span><span class="p">(</span>
		<span class="n">GettingListOfDeliveryAddresses</span><span class="p">,</span>
		<span class="n">to</span><span class="o">=</span><span class="n">SqlGettingListOfDeliveryAddresses</span><span class="p">,</span>
	<span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/auction/bids</span><span class="sh">"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">auction_bids</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="n">GettingListOfDeliveryAddresses</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="p">.</span><span class="nf">excute</span><span class="p">()</span>
	<span class="bp">...</span>

</code></pre></div></div>

  </div>
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/yamkant" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Yeham Kim. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
